<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Conversations</title>
  <style>
    .conversation { border: 1px solid #ccc; margin: 10px 0; padding: 5px; }
    .messages { display: none; margin-left: 20px; }
    .header { cursor: pointer; }
  </style>
</head>
<body>
  <h1>Conversations</h1>
  <div><a href="/">Back to Search</a></div>
  <div id="conv-list"></div>
  <script>
    async function load() {
      const res = await fetch('/conversations_data');
      const data = await res.json();
      const container = document.getElementById('conv-list');
      data.conversations.forEach(conv => {
        const div = document.createElement('div');
        div.className = 'conversation';
        const header = document.createElement('div');
        header.className = 'header';
        header.textContent = `Conversation ${conv.id} - Chris: ${conv.tone.Chris}, Hayley: ${conv.tone.Hayley}`;
        div.appendChild(header);
        const msgs = document.createElement('div');
        msgs.className = 'messages';
        conv.messages.forEach(m => {
          const p = document.createElement('p');
          p.textContent = `[${m.Date}] ${m.Sender}: ${m.Text}`;
          msgs.appendChild(p);
        });
        header.addEventListener('click', () => {
          msgs.style.display = msgs.style.display === 'none' ? 'block' : 'none';
        });
        div.appendChild(msgs);
        container.appendChild(div);
      });
    }
    load();
  </script>
</body>
</html>
